# Соглашения по разработке

> **Важно:** Полное техническое видение проекта описано в [vision.md](./vision.md). Данный документ содержит только правила для генерации кода.

## Основной принцип

**KISS** — максимальная простота, никакого оверинжиниринга. Только необходимое для MVP.

## Архитектура

### Трёхслойная структура
```
Controller → Service → Repository → Model
```

- **Контроллеры** — только координация, вызов сервисов, возврат ответов
- **Сервисы** — вся бизнес-логика
- **Репозитории** — работа с БД (CRUD, фильтрация, статистика)

### Разделение контроллеров
- `app/Http/Controllers/Api/` — API контроллеры
- `app/Http/Controllers/Web/` — Web контроллеры (админ-панель)

### Базовые классы
- Все сервисы наследуются от `BaseService`
- Все репозитории наследуются от `BaseRepository`

## Код

### PHP
- `declare(strict_types=1);` в начале каждого файла
- Type hints везде (параметры, возвращаемые значения, свойства)
- PSR-12 стандарт кодирования
- Early returns вместо глубокой вложенности
- Функциональный стиль где возможно

### Валидация
- **Только через FormRequest** — никакой валидации в контроллерах
- Валидация телефонов в формате E.164

### API ответы
- **Только через API Resources** — все API ответы форматируются через Resources

### Передача данных
- Массивы/объекты напрямую между слоями (без DTO)
- Без Events/Listeners на старте

## Frontend

### JavaScript
- **Только Vanilla JavaScript** — никаких фреймворков
- AJAX запросы для взаимодействия с API

### CSS
- **Только простой CSS** — никаких фреймворков (Tailwind, Bootstrap и т.д.)

### Blade
- Серверный рендеринг через Blade шаблоны

## Тестирование

- Тесты создаются по мере добавления функционала
- Базовое покрытие критичных частей (создание заявок, валидация)

## Запрещено

- ❌ Redis/кеширование
- ❌ Frontend фреймворки (React, Vue и т.д.)
- ❌ CSS фреймворки
- ❌ DTO классы
- ❌ Events/Listeners
- ❌ Валидация в контроллерах
- ❌ Бизнес-логика в контроллерах
- ❌ Прямые SQL запросы (только через Eloquent)
- ❌ `die()`, `exit()`, `var_dump()` в продакшен-коде
- ❌ `@` для подавления ошибок

## Структура файлов

См. раздел "Структура проекта" в [vision.md](./vision.md#3-структура-проекта)

## Модели данных

См. раздел "Модель данных" в [vision.md](./vision.md#5-модель-данных)

