# Техническое задание: Мини-CRM система

## 1. Краткое описание

Разработать мини-CRM для сбора и обработки заявок с сайта через универсальный виджет.

## 2. Сущности и их поля

### User (менеджер/админ)
- Имя
- Электронная почта
- Пароль

### Customer (клиент)
- Имя
- Номер телефона (Е.164)
- Электронная почта

### Ticket (заявка)
- Клиент (связь с Customer)
- Тема
- Текст
- Статус (новый/в работе/обработан)
- Дата ответа от менеджера

### File (файлы)
- Только через `spatie/laravel-medialibrary` (файлы привязаны к заявке)

## 3. Основные требования

- Проект должен включать миграции, фабрики и сидеры для User, Customer, Ticket (с тестовыми данными, включая менеджера и несколько заявок)
- Использовать `spatie/laravel-permission` для ролей
- Вся логика должна быть реализована через сервисы/репозитории, минимум логики в контроллерах
- Вся валидация входящих данных должна выполняться только через FormRequest (например, для телефонов - E.164)
- Код должен полностью соответствовать принципам SOLID, MVC, KISS, DRY, PSR-12
- Использовать Git, каждый этап как отдельный коммит (чистая история)

## 4. Виджет (Blade-страница)

- Реализовать отдельный роут `/widget` (или `/feedback-widget`) – Blade-страница с формой обратной связи для клиентов
- Виджет должен быть стилизован и готов для встраивания на другие сайты через тег `<iframe>` (пример: `<iframe src="https://your-domain.com/widget"></iframe>`)
- Вся логика отправки формы должна обрабатываться через AJAX (REST API: `/api/tickets`)
- Страница должна обрабатывать ошибки и успешные отправки, показывая сообщения пользователю

## 5. API и административная часть

### API (Все ответы должны быть отформатированы через API Resource)
- `POST /api/tickets` – для создания заявки
- `GET /api/tickets/statistics` – для статистики по заявкам (дневная, недельная, месячная)
  - Использовать Carbon и Eloquent scopes для расчетов

### Админ-панель (Blade UI, только для менеджеров)
- Просмотр списка заявок, с фильтрацией по дате, статусу, email, телефону
- Просмотр деталей заявки (включая все файлы, со ссылками на скачивание)
- Возможность изменения статуса заявки

## 6. Технические детали

- Чистый, структурированный проект на Laravel 12, PHP 8.4
- Весь функционал должен быть разбит на отдельные классы (сервисы, репозитории, модели, ресурсы и т.д.)
- `README.md` с полной инструкцией по запуску, списком тестовых данных, примером встраивания виджета (iframe) и примерами API

## 7. Будет плюсом

- `docker-compose` для быстрого локального запуска
- Покрытие функционала базовыми тестами
- Документация API (Swagger yaml)
- Ограничение на создание заявок: не более одной в день с одного номера/email
- Дополнительный файл с пояснениями: где и почему были приняты те или иные архитектурные или технические решения, почему выбраны конкретные библиотеки, описание особенностей реализации
- Рекомендуется не использовать AI (ChatGPT, Cursor и т.д.) для выполнения задания, а продемонстрировать реальные знания и опыт

